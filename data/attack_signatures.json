[
    {
        "id": "ssh_bruteforce",
        "name": "Intento de Fuerza Bruta SSH",
        "source": "log_auth",
        "pattern": "Failed password for",
        "window_seconds": 60,
        "threshold": 5
    },
    {
        "id": "high_cpu",
        "name": "CPU Crítica (>90%)",
        "source": "system_stats",
        "metric": "cpu_percent",
        "window_seconds": 30,
        "threshold": 3
    },
    {
        "id": "high_ram",
        "name": "Memoria Crítica (>95%)",
        "source": "system_stats",
        "metric": "memory_percent",
        "window_seconds": 60,
        "threshold": 5
    },
    {
        "id": "sudo_abuse",
        "name": "Uso sospechoso de SUDO",
        "source": "log_auth",
        "pattern": "sudo: pam_unix(sudo:auth): authentication failure",
        "window_seconds": 300,
        "threshold": 3
    },
    {
        "id": "sql_injection",
        "name": "Intento de Inyección SQL",
        "source": "log_auth",
        "pattern": "UNION SELECT",
        "window_seconds": 60,
        "threshold": 3
    },
    {
        "id": "xss_attempt",
        "name": "Intento de XSS",
        "source": "log_auth",
        "pattern": "<script>",
        "window_seconds": 60,
        "threshold": 3
    },
    {
        "id": "disk_space_critical",
        "name": "Espacio en Disco Crítico (>90%)",
        "source": "system_stats",
        "metric": "disk_percent",
        "window_seconds": 300,
        "threshold": 1
    },
    {
        "id": "port_scan",
        "name": "Escaneo de Puertos Detectado",
        "source": "log_auth",
        "pattern": "Connection closed by [preauth]",
        "window_seconds": 10,
        "threshold": 10
    }
]